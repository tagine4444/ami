<div class="row">

	<div ng-include="'/app/components/toolbar/toolbar.html'"></div>

	<div class="row" ng-show="hasBeenSaved()">
		<div class="col-sm-9" >
			<h4><span class="label label-primary">Case# {{caseNumber}}</span>
		    </h4>
		</div>
		<div class="col-sm-3">
		</div>
	</div>	
	
	
   
	<form name="newRequestForm" ng-submit="saveNewRequest()"   >
	
	
   	<div class="row">
   		<div class="col-sm-8">
   			
<!-- 	<p ng-show="newRequestForm.$invalid && isShowIncompleteFormMsg"></p> -->
   	
   	
   	<p class="alert alert-warning" role="alert"  ng-show="newRequestForm.$invalid && isShowIncompleteFormMsg">You can't submit to radiologist until all required fields are provided. You can however save this request as a draft</p>
   		</div>
   	</div>
   	<br/>
<!--    	<p ng-show="hasBeenSaved()" >Your Request Number is {{caseNumber}} </p> -->
   	<p ng-show="isEditable==false"> <span class="label label-danger">**Read Only Request**</span>  This request can no longer be edited as it has been submitted to the radiologist</p>
   	
	<div class="panel panel-default">
	  <div class="panel-heading"><strong>{{hospitalName}} &amp; Client Section</strong></div>
	  <div class="panel-body">
	    <!--  Veterinarian and Lab Row -->
	    
	 	    
	    <div class="row">
		     <div class="col-sm-5" ng-show="!userEmailIsHospitalEmail">
			    Send the report to <span style="font-weight: bold;">my email? </span>  &nbsp; <a href =""  data-toggle="modal" data-target="#myEmailModal" >(Click for help)</a> &nbsp;
			  
			    <label class="radio-inline">
				  <input  type="radio"  id="emailRadio1" ng-click='sendRequestToPersonalEmail(true)' ng-model="newRequest.hospitalAndClientInfo.isRequestSentToPersonalEmail" ng-checked="newRequest.hospitalAndClientInfo.isRequestSentToPersonalEmail" >Yes
				</label>
				<label class="radio-inline">
				  <input type="radio"  id="emailRadio2"  ng-click='sendRequestToPersonalEmail(false)' ng-checked="!newRequest.hospitalAndClientInfo.isRequestSentToPersonalEmail" >No
				</label>
				
			</div>
			
			<div class="col-sm-4">
			    <span >Is the client an employee? </span> &nbsp;
			
			    <label class="radio-inline">
				  <input  type="radio"  id="empoyeeRadio1" ng-click='isEmployee(true)' ng-model="newRequest.hospitalAndClientInfo.isEmployee" ng-checked="newRequest.hospitalAndClientInfo.isEmployee" >Yes
				</label>
				<label class="radio-inline">
				  <input type="radio"  id="empoyeeRadio2"  ng-click='isEmployee(false)' ng-checked="!newRequest.hospitalAndClientInfo.isEmployee" >No
				</label>
			</div>
			
		</div>
		
		<br/>
		
	    <div class="row">
		    <div class="col-sm-3">
		    	<div class="form-group" ng-class="{ 'has-error' : newRequestForm.vetId.$invalid }">
				  <input autofocus="autofocus" type="text" name="vetId" class="form-control" id="vetId" ng-model='newRequest.hospitalAndClientInfo.vet' placeholder="Veterinarian" ng-required='isSubmit()'>
				</div>
				
		    </div>

		    <div class="col-sm-3">
			    <div class="form-group" ng-class="{ 'has-error' : newRequestForm.clientFirstName.$invalid && !newRequestForm.clientFirstName.$pristine }">
				    <input type="text" name="clientFirstName" class="form-control" ng-model="newRequest.hospitalAndClientInfo.clientFirstName" placeholder="Client's First Name" ng-required='isSubmit()'  >
				    <p ng-show="newRequestForm.clientFirstName.$invalid && !newRequestForm.clientFirstName.$pristine" class="help-block">required field</p>
				</div>
		    </div>
		    
		    <div class="col-sm-3">
		    	
		    	<div class="form-group" ng-class="{ 'has-error' : newRequestForm.clientLastName.$invalid && !newRequestForm.clientLastName.$pristine }">
				    <input type="text" name="clientLastName" class="form-control" ng-model="newRequest.hospitalAndClientInfo.clientLastName" placeholder="Client's Last Name" ng-required='isSubmit()'>
				    <p ng-show="newRequestForm.clientLastName.$invalid && !newRequestForm.clientLastName.$pristine" class="help-block">required field</p>
				</div>
		    
		    </div>
		    
		    <div class="col-sm-2">
		      <input type="text" class="form-control" id="labActId" ng-model= "newRequest.hospitalAndClientInfo.clientId" placeholder="Client's Id">
		    </div>

		</div>
	  </div>
	</div> <!-- End of 1st pannel -->
	
	<div class="panel panel-default">
	  <div class="panel-heading"><strong>Patient Section</strong></div>
	  	<div class="panel-body">
	  
		    <div class="row">
		    
		    	<div class="col-sm-2">
			      <input type="text" class="form-control" id="animalNameId" ng-model="newRequest.patientInfo.animalName" placeholder="Animal's Name">
			    </div>
			    
			     <div class="col-sm-2">
				       <select class="form-control" ng-model="newRequest.patientInfo.animalSex" ng-selected="newRequest.patientInfo.animalSex">
						  <option  ng-repeat="animalSex in animalSexList">{{animalSex}}</option>
						</select>
				 </div>
				 
				<!-- Weight -->
				<div class="col-sm-3">	    
					<div class="form-inline">
					  <div class="form-group">
						  	<input type="text" class="form-control" id="weightId" ng-model="newRequest.patientInfo.animalWeight"  placeholder="weight">
						  
						  		<select class="form-control" ng-model="newRequest.patientInfo.animalWeightUom">
									<option ng-selected="$index==0" ng-repeat="anAnimalWeightUom in animalWeightUomList">{{anAnimalWeightUom}}</option>
							    </select>
					  </div>
					</div>
				</div>
				
				<!-- Age -->
				<div class="col-sm-5">	    
					<div class="form-inline">
						<div class="form-group">
								<label  for="ageLabId">Age:</label>
								    
							    <div class="input-group">
							      <select id="ageLabId" class="form-control" ng-model="newRequest.patientInfo.animalAgeYears" ng-change="updateAnimalYearsLabel()">
									  <option ng-repeat="animalYears in animalAgeYearsList">{{animalYears}}</option>
									</select>
							    </div>
								    
							    <div class="input-group">
							       <select  id="monghLabId" class="form-control" ng-model="newRequest.patientInfo.animalAgeMonths" ng-change="updateAnimalYearsLabel()">
									  <option ng-repeat="animalMonths in animalAgeMonthsList">{{animalMonths}}</option>
									</select>
							    </div>
								{{ newRequest.patientInfo.ageLabel }} 
						</div>
					</div>
				</div>
			</div>
		
			<br/>
			
			<div class="row">
			     <div class="col-sm-4">
<!-- 				    <select class="form-control" ng-model="newRequest.patientInfo.species" ng-change="updateBreedListBox()"> -->
<!-- 						 <option  ng-repeat="aSpecies in speciesList">{{aSpecies}}</option> -->
<!-- 					</select> -->
					<input type="text" class="form-control" id="speciesId" ng-model="newRequest.patientInfo.species" placeholder="Species">
			    </div>
			    
			    <div class="col-sm-4">
<!-- 				      <select class="form-control" ng-model="newRequest.patientInfo.breeds" ng-disabled ="disableBreedList" > -->
<!-- 						   <option ng-repeat="aBreed in breedsList">{{aBreed}}</option> -->
<!-- 						</select> -->

						<input type="text" class="form-control" id="breedsId" ng-model="newRequest.patientInfo.breeds" placeholder="Breeds">
			    </div>
			</div>
		
	    </div>
	</div> <!--  End of Patient Info panel -->
	
	<div class="panel panel-default">
	  <div class="panel-heading"><strong>Requested Services</strong></div>
	  <div class="panel-body">
	  		
	  		<div class="row">
				
				<div class="col-sm-5">
				</div>
				
				<div class="col-sm-7">
					<p ng-show="isImageModalityNotSelected()"><strong>Click on the &quot;Select Service&quot; button </strong> to select a {{serviceCategory}} service. </p>
				</div>
		  		<div class="col-sm-5">
				    <label class="radio-inline">
					  <input type="radio" id="imagingRadio1" ng-click='isInterpretationOnly(true)'  ng-model="newRequest.requestedServices.isInterpretationOnly"  ng-checked="newRequest.requestedServices.isInterpretationOnly" >Interpretation Only
					</label>
					<label class="radio-inline">
						<input type="radio" id="imagingRadio2" ng-click='isInterpretationOnly(false)'  ng-checked="!newRequest.requestedServices.isInterpretationOnly" >Imaging (includes interpretation)
					</label>
				</div>
				
				<div class="col-sm-4">
			      <select class="form-control" ng-disabled="newRequest.requestedServices.isInterpretationOnly" ng-model="serviceCategory" >
			      		<option ng-selected="true" >Imaging Modalities</option>
				      	<option ng-repeat='(key, value) in servicesList'  > {{key}}</option>
					</select>
					<br>
			    </div>
			    
			    <div class="col-sm-2">
				    <button  type="button" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#myModal" 
				    ng-click="updateServicesListByCategory()"
				    ng-show="isImageModalityNotSelected()">
						  Select Service
					</button>
		  		</div>	
		  		 
		  		<div class="col-sm-1">
					<label class="checkbox-inline">
					  <input type="checkbox" id="statCheckbox" ng-model="newRequest.requestedServices.isStat" ng-true-value="true" ng-false-value="false"> <span class="label label-danger">STAT</span>
					</label>
				</div>
				
				<div class="col-sm-6">
					<span ng-show="newRequest.requestedServices.selectedServices.length==0">No Services Added</span>
					
					<table class="table" ng-show="newRequest.requestedServices.selectedServices.length>0" >
				  	<thead>
				  		<tr>
				  			<th>Selected Services</th>
				  			<th></th>
				  		</tr>
				  	</thead>
				  	<tbody ng-repeat="aSvc in newRequest.requestedServices.selectedServices">
			        		<tr> 
					  			<td>{{aSvc}}</td>
					  			<td>
					  			 	<a href ng-click="deleteFilteredItem(aSvc )">Remove </a>
					  			</td>
				  			</tr>
				  	</tbody>		
				  </table>
					
					
					
				</div>
			</div>
		 </div>
	  </div>
<!-- 	</div> -->
	
	<div class="panel panel-default">
	  <div class="panel-heading"><strong>Veterinarian Observation</strong></div>
	    <div class="panel-body">
		  <div class="row">
			   <div class="col-sm-12">
				   <label class="checkbox-inline">
					  <input type="checkbox" id="inlineCheckbox1" ng-model="newRequest.vetObservation.anesthetized">Anesthetized?
					</label>
					<label class="checkbox-inline">
					  <input type="checkbox" id="inlineCheckbox2" ng-model="newRequest.vetObservation.sedated">Sedated?
					</label>
					<label class="checkbox-inline">
					  <input type="checkbox" id="inlineCheckbox3" ng-model="newRequest.vetObservation.fasted">Fasted?
					</label>
					<label class="checkbox-inline">
					  <input type="checkbox" id="inlineCheckbox3" ng-model="newRequest.vetObservation.enema">Enema?
					</label>
					<label class="checkbox-inline">
					  <input type="checkbox" id="inlineCheckbox3" ng-model="newRequest.vetObservation.painful">Painful?
					</label>
					<label class="checkbox-inline">
					  <input type="checkbox" id="inlineCheckbox3" ng-model="newRequest.vetObservation.fractious">Fractious?
					</label>
					<label class="checkbox-inline">
					  <input type="checkbox" id="inlineCheckbox3" ng-model="newRequest.vetObservation.shocky">Shocky?
					</label>
					<label class="checkbox-inline">
					  <input type="checkbox" id="inlineCheckbox3" ng-model="newRequest.vetObservation.dyspneic">Dyspneic?
					</label>
					<label class="checkbox-inline">
					  <input type="checkbox" id="inlineCheckbox3" ng-model="newRequest.vetObservation.died">Died?
					</label>
					<label class="checkbox-inline">
					  <input type="checkbox" id="inlineCheckbox3" ng-model="newRequest.vetObservation.euthanized">Euthanized?
					</label>
				</div>
				
				<div class="col-sm-12">
			  		
			   	</div>
			   
			    <div class="col-sm-12">
					  	<div class="form-group">	
<!-- 						    <label for="exampleInputEmail1">Exam</label> -->
							<div class="form-group" ng-class="{ 'has-error' : newRequestForm.exam.$invalid && !newRequestForm.exam.$pristine }">
							    <textarea name="exam" id="exam" class="form-control" rows="3" ng-model="newRequest.vetObservation.exam" ng-required='isSubmit()'
							    placeholder="HISTORY, CHIEF COMPLAIN, PHYSICAL FINDINGS (S.O.A.P). Please provide a summary, not the entire record." ></textarea>
							    <p ng-show="newRequestForm.exam.$invalid && !newRequestForm.exam.$pristine" class="help-block">required field</p>
							</div>
					    </div>
					  	<div class="form-group">
<!-- 						    <label for="exampleInputEmail1">Tentative Diagnosis</label> -->
						    
						    <div class="form-group" ng-class="{ 'has-error' : newRequestForm.tentativeDiagnosis.$invalid && !newRequestForm.tentativeDiagnosis.$pristine }">
							    <textarea name="tentativeDiagnosis" id="tentativeDiagnosis" class="form-control" rows="3" ng-model="newRequest.vetObservation.tentativeDiagnosis" ng-required='isSubmit()'
							     placeholder="Tentative Diagnosis" ></textarea>
							    <p ng-show="newRequestForm.tentativeDiagnosis.$invalid && !newRequestForm.tentativeDiagnosis.$pristine" class="help-block">required field</p>
							</div>
						    
					    </div>
		    	</div>
		    </div>
	    </div>
	</div>
	
	<div class="panel panel-default">
	  <div class="panel-heading"><strong>Documents &#47; Notes</strong></div>
	    <div class="panel-body">
		  	<div class="row">
		  		<div class="col-sm-12">
			  		<p>I am providing documents with this request.</p>
			   	</div>
			   	
		   		<div class="col-sm-12">
		   		<span id = "uploadCheckCheckboxDivId" >
		   		   <label class="checkbox-inline" >
					
					  <input type="checkbox" id="uploadCheckCheckbox" 
					  ng-model="newRequest.imagesAndDocuments.hasDocumentDeliveredByUpload"
					  />By Upload
					</label>
				</span>	
				   <label class="checkbox-inline">
					  <input type="checkbox" id="carrierCheckboxId" ng-model="newRequest.imagesAndDocuments.hasDocumentDeliveredByCarrier">By Carrier
					</label>
				</div>
				</div>
				
				<div class="col-sm-12">
				      
				    <div class="form-group">	
				  		<div  ng-show="!hasBeenSaved()">
					  </div>
				    </div>
				    
				    <div class="col-sm-12">	    
						<div class="form-inline">
						  
						  <button 
				        	ng-show="isEditable==true && newRequest.imagesAndDocuments.hasDocumentDeliveredByUpload"
				        	ng-click="setAction('transfer')" 
				        	data-toggle="modal" 
					        data-target="#uploadModal" class="btn btn-default" 
					        ng-show="newRequest.imagesAndDocuments.hasDocumentDeliveredByUpload"
					        ng-disabled="!hasBeenSaved()">
					        Upload Images</button>
					       
						  <div class="form-group" ng-show="newRequest.imagesAndDocuments.hasDocumentDeliveredByCarrier" >
								  <div class="input-group">
								  	<input type="text" class="form-control" id="labActId" ng-model="newRequest.imagesAndDocuments.labAccount" placeholder="Lab Account">
								  </div>
								  <div class="input-group">
										<select class="form-control" ng-model="newRequest.imagesAndDocuments.labs" ng-selected="newRequest.imagesAndDocuments.labs">
											<option ng-repeat="lab in labsList">{{lab}}</option>
									    </select>
								 </div> 
						  </div>
						  
						   <br/>
					        <p style="color:red;" ng-show="showTransferFileMsg()">The Upload Images button is disabled. To enable it, you must <strong>first push the blue button labeled &quot;Save As Draft&quot; </strong> </p>
						  
						  
						</div>
					</div>
				    
		    	</div>
		    	
		    	
		    	 				
				<div class="col-sm-12">
				  	<div class="form-group">	
					    <label for="exampleInputEmail1">Notes</label>
					    <textarea class="form-control" ng-model="newRequest.imagesAndDocuments.notes" rows="3" placeholder="If you have any additional information about this request you'd like provide, this is the place!"></textarea>
				    </div>
		    	</div>
		    	
		    	<div class="col-sm-10">
<!-- 			        <button  -->
<!-- 			        	ng-show="isEditable==true" -->
<!-- 			        	ng-click="setAction('transfer')"  -->
<!-- 			        	data-toggle="modal"  -->
<!-- 				        data-target="#uploadModal" class="btn btn-default"  -->
<!-- 				        ng-show="newRequest.imagesAndDocuments.hasDocumentDeliveredByUpload" -->
<!-- 				        ng-disabled="!hasBeenSaved()"> -->
<!-- 				        Add images to this request</button> -->
				        
   					<button ng-show="isEditable==true" ng-click="setAction('draft')" type="submit" class="btn btn-primary">Save As Draft</button>
		    	</div>
		    	
		    	<div class="col-sm-2">
		    		<button ng-show="isEditable==true" ng-click="setAction('submit')" type="submit" class="btn btn-danger"  >Submit To Radiologist</button>
		    	</div>
		    	<div class="col-sm-12">
		    	
				</div>
			</div>	
	    </div>
	    
	    <div id="uploadedFilesDiv" class="col-sm-3" ng-show="newRequest.imagesAndDocuments.hasDocumentDeliveredByUpload">
	    
	     <table class="table">
			  	<thead>
			  		<tr>
			  			<th>Num</th>
			  			<th>Uploaded Files</th>
			  			<th></th>
			  		</tr>
			  	</thead>
			  	<tbody ng-repeat="aFileUpload in fileUploads">
		        		
		        		<tr> 
		        			<td>{{$index +1 }}</td>
				  			<td>{{aFileUpload.originalFileName}}</td>
				  			<td> <a ng-show="isEditable==true" ng-click="deleteUploadedFile(aFileUpload.fileName)">Remove</a></td>
			  			</tr>
			  	</tbody>		
			  </table>
	    
	    
	    </div>
</form>	    
	   
	   
	 <!-- Modal -->
	<div class="modal fade bs-example-modal-lg" id="myEmailModal" tabindex="-1" role="dialog" aria-labelledby="myEmailModalLabel" aria-hidden="true">
	  <div class="modal-dialog modal-lg">
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	        <h4 class="modal-title" id="myEmailModalLabel">Report Email Notification</h4>
	      </div>
	      <div class="modal-body">
				<div class="row">
		          <div class="col-md-12">
		          		<p>When the report is ready, a notification will be send to the following email(s).</p>
		         		<ul ng-repeat="aHospitalEmail in hospitalEmails">
		         			<li><strong>{{aHospitalEmail.value}}</strong></li>
		         		</ul>
		          </div>
		          
		          <div class="col-md-12" ng-show="!userEmailIsHospitalEmail">
		          	<p>If you check <strong>Yes</strong>, a notification will also be sent to your email: <strong>{{userEmail}}</strong></p>
		          </div>
		        </div>
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	      </div>
	    </div>
	  </div>
	</div>
	   
   <!-- Modal -->
	<div class="modal fade bs-example-modal-lg" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	  <div class="modal-dialog">
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	        <h4 class="modal-title" id="myModalLabel">A.M.I Services</h4>
	      </div>
	      <div class="modal-body">
	      
	      	<div class="panel panel-default">
			  <!-- Default panel contents -->
			  <div class="panel-heading">{{serviceCategory}} Services</div>
			
			  <!-- Table -->
			  <table class="table">
			  	<thead>
			  		<tr>
			  			<th></th>
			  		</tr>
			  	</thead>
			  	<tbody ng-repeat="aService in servicesListByCategory">
		        		<tr> 
				  			<td>{{aService.name}}</td>
				  			<td>
				  			 	<button  type="button" class="btn btn-primary btn-sm" data-dismiss="modal" ng-click="selectThisService(serviceCategory, aService)">Add</button>
				  			</td>
			  			</tr>
			  	</tbody>		
			  </table>
			</div>
	        
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	      </div>
	    </div>
	  </div>
	</div>
	
	
	
	<!-- Modal -->
	<div class="modal fade bs-example-modal-lg" id="uploadModal" tabindex="-1" role="dialog" aria-labelledby="uploadModalLabel" aria-hidden="true">
	  <div class="modal-dialog">
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	        <h4 class="modal-title" id="uploadModalLabel">Add images to this request</h4>
	      </div>
	      <div class="modal-body">
	      
	      	<div class="panel panel-default">
			  <!-- Default panel contents -->
			  <div class="panel-heading">
				  <p ng-show="uploader.flow.files.length==0">Push the &quot;Select Images&quot; (blue button) to select images</p>
			  	  <div ng-show="uploader.flow.files.length>0">
			         <ol>
				         <li>Push the Select Images button or the remove link to add or Remove images</li>
				         <li><strong>Push the upload button</strong> when you are done.</li>
			         </ol>
		          </div>
			  </div>
			  
			  	<div class="col-sm-12">
		    		
					<div flow-init="{target:'/ami/doupload', testChunks:false, permanentErrors: [404, 500, 501], maxChunkRetries: 1,chunkRetryInterval: 5000,simultaneousUploads: 4, singleFile: false}" flow-name="uploader.flow"
					 	flow-file-added="uploader.fileAdded($flow, $file, $message)"
					 	flow-files-submitted ="uploader.fileSubmitted($flow, $file, $message)"
					 	flow-upload-started ="uploader.fileUploadStarted($flow, $file, $message)"
					 	flow-complete ="uploader.fileCompleted($flow, $file, $message)"
					 	
					 	>     
				        
					        <br/><br/>
					        <button class="btn btn-primary" 
					        	flow-btn ng-click="setAction('addFiles')" 
					        	data-trigger="hover" 
	          					data-placement="top"
	          					data-title="Select the documents to transfer"
	          					bs-tooltip>Select Images
					        	<span class="btn-primary glyphicon glyphicon-plus" aria-hidden="true"></span>
					        </button>
		   					
					        <br/> <br/>
					        
					         
					         
					        <div class="panel panel-default" ng-show="uploader.flow.files.length>0">
								  <!-- Default panel contents -->
								  <div class="panel-heading">
									  Images Selected for upload<br/>
								 </div>
								  <table class="table">
								  	 <thead>
									   <tr>
									   	<th>File Name</th>
									   	<th></th>
									   </tr>
									  </thead>
								  	<tbody>
								  		<tr ng-repeat="file in uploader.flow.files" >
								         	<td>{{file.name}}</td>
								         	<td> <a ng-click="file.cancel()">Remove</a></td>
							        	</tr>
								  	</tbody>
								    
								  </table>
							</div>
				       </div>
		    	</div>
			</div>
	        
	      </div>
	      <div class="modal-footer">
	      	 <button class="btn btn-danger" ng-show="uploader.flow.files.length>0" 
					        	data-dismiss="modal"
					        	ng-click="upload()"  
					        	data-trigger="hover" 
	          					data-placement="top"
	          					data-title="Transfer documents"
	          					bs-tooltip>Upload
					        	<span class="btn-danger glyphicon glyphicon-upload" aria-hidden="true"></span>
					        </button> &nbsp;
	        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
	      </div>
	    </div>
	  </div>
	</div>
	    
</div>